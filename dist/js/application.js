!function(){var a={card:$("#tmpl-card").html(),plan:$("#tmpl-plan").html()},b={currentMeal:null,liked:[],discard:[]},c=[{id:1,image:"http://lh5.ggpht.com/east-MMyMjVPuc3nlC4trgJBg7O4nbTJvD6ZmkqYSy2YgN5QwYrc_ZqdvP2iB7MEmAEGWsCZPLnDAlq7eixg=s730-e365",type:"common",title:"Meatloaf",calories:150,time:"30min"},{id:2,image:"http://lh5.ggpht.com/east-MMyMjVPuc3nlC4trgJBg7O4nbTJvD6ZmkqYSy2YgN5QwYrc_ZqdvP2iB7MEmAEGWsCZPLnDAlq7eixg=s730-e365",type:"common",title:"Tacos",calories:350,time:"10min"},{id:3,image:"http://lh5.ggpht.com/east-MMyMjVPuc3nlC4trgJBg7O4nbTJvD6ZmkqYSy2YgN5QwYrc_ZqdvP2iB7MEmAEGWsCZPLnDAlq7eixg=s730-e365",type:"common",title:"Speghetti",calories:250,time:"20min"},{id:4,image:"http://lh5.ggpht.com/east-MMyMjVPuc3nlC4trgJBg7O4nbTJvD6ZmkqYSy2YgN5QwYrc_ZqdvP2iB7MEmAEGWsCZPLnDAlq7eixg=s730-e365",type:"diverse",title:"Tacos de Lingua",calories:150,time:"20min"},{id:5,image:"http://lh5.ggpht.com/east-MMyMjVPuc3nlC4trgJBg7O4nbTJvD6ZmkqYSy2YgN5QwYrc_ZqdvP2iB7MEmAEGWsCZPLnDAlq7eixg=s730-e365",type:"diverse",title:"Chicken Alfredo",calories:300,time:"40min"},{id:6,image:"http://lh5.ggpht.com/east-MMyMjVPuc3nlC4trgJBg7O4nbTJvD6ZmkqYSy2YgN5QwYrc_ZqdvP2iB7MEmAEGWsCZPLnDAlq7eixg=s730-e365",type:"diverse",title:"Fried Rice with Pork Tenderlion",calories:150,time:"30min"},{id:7,image:"http://lh5.ggpht.com/east-MMyMjVPuc3nlC4trgJBg7O4nbTJvD6ZmkqYSy2YgN5QwYrc_ZqdvP2iB7MEmAEGWsCZPLnDAlq7eixg=s730-e365",type:"common",title:"Raised Meatballs and Rice",calories:245,time:"20min"},{id:8,image:"http://lh5.ggpht.com/east-MMyMjVPuc3nlC4trgJBg7O4nbTJvD6ZmkqYSy2YgN5QwYrc_ZqdvP2iB7MEmAEGWsCZPLnDAlq7eixg=s730-e365",type:"diverse",title:"Tortilla Soup",calories:400,time:"1hr"},{id:9,image:"http://lh5.ggpht.com/east-MMyMjVPuc3nlC4trgJBg7O4nbTJvD6ZmkqYSy2YgN5QwYrc_ZqdvP2iB7MEmAEGWsCZPLnDAlq7eixg=s730-e365",type:"common",title:"Waffles & Eggs",calories:310,time:"30min"},{id:10,image:"http://lh5.ggpht.com/east-MMyMjVPuc3nlC4trgJBg7O4nbTJvD6ZmkqYSy2YgN5QwYrc_ZqdvP2iB7MEmAEGWsCZPLnDAlq7eixg=s730-e365",type:"diverse",title:"Chicken and Waffles",calories:100,time:"10min"},{id:11,image:"http://lh5.ggpht.com/east-MMyMjVPuc3nlC4trgJBg7O4nbTJvD6ZmkqYSy2YgN5QwYrc_ZqdvP2iB7MEmAEGWsCZPLnDAlq7eixg=s730-e365",type:"diverse",title:"Misu Soup",calories:250,time:"300min"}],d=function(a,b){for(var c=[],d=0;d<b.length;d++){for(var e=!1,f=0;f<a.length;f++)b[d].id==a[f].id&&(e=!0);e||c.push(b[d])}return c},e=function(a){for(var b=0,c=0;c<a.length;c++)"common"==a[c].type&&b++;return b},f=function(){var a=d(b.liked,c),f=e(b.liked),g=b.liked.length-f;5>f&&2>g?probabilityOfCommon=.5:5>f&&2==g?probabilityOfCommon=1:f>=5&&(probabilityOfCommon=0);var h=probabilityOfCommon>Math.random()?"common":"diverse";if(a=$(a).filter(function(a,b){return b.type==h}),0==a.length)throw new Error("Out of recipies");return a[Math.floor(Math.random()*a.length)]},g=function(a,b){return Mustache.render(a,b)},h=function(){if(b.liked.length<7)try{b.currentMeal=f();var c=k(g(a.card,b.currentMeal));$("#cards .option").hide(),$("#cards").append(c)}catch(d){alert(d)}else m()},i=function(){b.discard.push(b.currentMeal),h()},j=function(){b.liked.push(b.currentMeal),h()},k=function(a){return a=$(a),$('button[data-action="yes"]',a).on("click",j),$('button[data-action="no"]',a).on("click",i),a},l=function(){alert("This feature is not avaliable yet")},m=function(){var c=g(a.plan,{meals:b.liked});$("#app").html(c),$('button[data-action="shopping-list"]').on("click",l)};$('button[data-action="start"]').on("click",function(){$("#welcome").remove(),h()})}();